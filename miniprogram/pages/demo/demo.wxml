<!--Demoé¡µé¢ç•Œé¢-->
<view class="demo-container">
  <!-- å¤´éƒ¨æ ‡é¢˜ -->
  <view class="demo-header">
    <text class="demo-title">ğŸ¬ P-Word åŠŸèƒ½éªŒæ”¶Demo</text>
    <view class="demo-subtitle">Day {{currentDay}} - å¼€å‘æˆæœå±•ç¤º</view>
  </view>

  <!-- Tabå¯¼èˆª -->
  <view class="demo-tabs">
    <view 
      wx:for="{{tabs}}" 
      wx:key="name"
      class="tab-item {{currentTab === index ? 'active' : ''}}"
      data-index="{{index}}"
      bindtap="switchTab"
    >
      <text class="tab-icon">{{item.icon}}</text>
      <text class="tab-name">{{item.name}}</text>
    </view>
  </view>

  <!-- å½•éŸ³åŠŸèƒ½æµ‹è¯• -->
  <view class="tab-content" wx:if="{{currentTab === 0}}">
    <view class="section-title">ğŸ¤ å½•éŸ³åŠŸèƒ½æµ‹è¯•</view>
    
    <!-- å½•éŸ³æ§åˆ¶ -->
    <view class="record-controls">
      <button 
        class="record-btn {{isRecording ? 'recording' : ''}}"
        bindtap="startRecordingTest"
        disabled="{{isRecording}}"
      >
        {{isRecording ? 'å½•éŸ³ä¸­...' : 'å¼€å§‹å½•éŸ³'}}
      </button>
      
      <button 
        class="stop-btn"
        bindtap="stopRecordingTest"
        disabled="{{!isRecording}}"
      >
        åœæ­¢å½•éŸ³
      </button>
      
      <button 
        class="play-btn"
        bindtap="playRecordingTest"
        disabled="{{!hasRecording}}"
      >
        æ’­æ”¾æµ‹è¯•
      </button>
    </view>

    <!-- å½•éŸ³çŠ¶æ€ -->
    <view class="record-status">
      <view class="status-item">
        <text class="label">å½•éŸ³æ—¶é•¿:</text>
        <text class="value">{{recordDuration}}ç§’</text>
      </view>
      <view class="status-item" wx:if="{{audioQuality}}">
        <text class="label">è´¨é‡è¯„åˆ†:</text>
        <text class="value quality-{{audioQuality.level}}">{{audioQuality.overall}}åˆ†</text>
      </view>
    </view>

    <!-- æ³¢å½¢æ˜¾ç¤º -->
    <view class="waveform-container">
      <view class="waveform-title">å®æ—¶æ³¢å½¢</view>
      <view class="waveform-display">
        <view 
          wx:for="{{waveData}}" 
          wx:key="index"
          class="wave-bar"
          style="height: {{item * 50}}px;"
        ></view>
      </view>
    </view>

    <!-- æµ‹è¯•ç»“æœ -->
    <view class="test-results">
      <view class="result-title">æµ‹è¯•ç»“æœ</view>
      <view class="result-grid">
        <view class="result-item">
          <text class="result-label">å½•éŸ³åŠŸèƒ½</text>
          <text class="result-status {{testResults.recording ? 'success' : 'pending'}}">
            {{testResults.recording || 'å¾…æµ‹è¯•'}}
          </text>
        </view>
        <view class="result-item">
          <text class="result-label">è´¨é‡åˆ†æ</text>
          <text class="result-status {{testResults.quality ? 'success' : 'pending'}}">
            {{testResults.quality ? testResults.quality + 'åˆ†' : 'å¾…æµ‹è¯•'}}
          </text>
        </view>
        <view class="result-item">
          <text class="result-label">éŸ³é¢‘æ’­æ”¾</text>
          <text class="result-status {{testResults.playback ? 'success' : 'pending'}}">
            {{testResults.playback || 'å¾…æµ‹è¯•'}}
          </text>
        </view>
      </view>
    </view>
  </view>

  <!-- è¯­æ–™åº“åŠŸèƒ½æµ‹è¯• -->
  <view class="tab-content" wx:if="{{currentTab === 1}}">
    <view class="section-title">ğŸ“š è¯­æ–™åº“ç³»ç»Ÿæµ‹è¯•</view>
    
    <!-- æ¨èæ¨¡å¼æµ‹è¯• -->
    <view class="recommendation-tests">
      <view class="test-buttons">
        <button class="test-btn smart" bindtap="testSmartRecommendation">
          ğŸ§  æ™ºèƒ½æ¨è
        </button>
        <button class="test-btn random" bindtap="testRandomRecommendation">
          ğŸ”€ éšæœºæ¨è
        </button>
      </view>
      
      <!-- åˆ†ç±»ç­›é€‰ -->
      <view class="category-filters">
        <text class="filter-title">åˆ†ç±»ç­›é€‰:</text>
        <scroll-view class="category-scroll" scroll-x>
          <view 
            wx:for="{{availableCategories}}" 
            wx:key="*this"
            class="category-tag {{selectedCategory === item ? 'active' : ''}}"
            data-category="{{item}}"
            bindtap="testCategoryFilter"
          >
            {{item}}
          </view>
        </scroll-view>
      </view>
    </view>

    <!-- å½“å‰å¥å­å±•ç¤º -->
    <view class="sentence-display" wx:if="{{currentSentence}}">
      <view class="sentence-card">
        <view class="sentence-content">{{currentSentence.content}}</view>
        <view class="sentence-translation">{{currentSentence.translation}}</view>
        <view class="sentence-meta">
          <text class="level">{{currentSentence.level}}</text>
          <text class="category">{{currentSentence.category}}</text>
          <text class="difficulty">éš¾åº¦: {{currentSentence.difficulty}}</text>
        </view>
      </view>
    </view>

    <!-- è¯­æ–™åº“ç»Ÿè®¡ -->
    <view class="sentence-stats">
      <view class="stats-title">è¯­æ–™åº“ç»Ÿè®¡</view>
      <view class="stats-grid">
        <view class="stat-item">
          <text class="stat-value">{{sentenceStats.total}}</text>
          <text class="stat-label">æ€»å¥æ•°</text>
        </view>
        <view class="stat-item">
          <text class="stat-value">{{availableCategories.length}}</text>
          <text class="stat-label">åˆ†ç±»æ•°</text>
        </view>
        <view class="stat-item">
          <text class="stat-value">{{recommendationMode}}</text>
          <text class="stat-label">æ¨èæ¨¡å¼</text>
        </view>
      </view>
    </view>
  </view>

  <!-- äº‘åŒæ­¥åŠŸèƒ½æµ‹è¯• -->
  <view class="tab-content" wx:if="{{currentTab === 2}}">
    <view class="section-title">â˜ï¸ äº‘åŒæ­¥åŠŸèƒ½æµ‹è¯•</view>
    
    <!-- åŒæ­¥çŠ¶æ€ -->
    <view class="sync-status">
      <view class="status-card">
        <view class="status-icon">{{syncStatus.isOnline ? 'â˜ï¸' : 'ğŸ“±'}}</view>
        <view class="status-text">{{syncStatus.isOnline ? 'åœ¨çº¿' : 'ç¦»çº¿'}}</view>
        <view class="queue-info">é˜Ÿåˆ—: {{syncStatus.queueLength}}æ¡</view>
      </view>
    </view>

    <!-- åŒæ­¥æµ‹è¯•æŒ‰é’® -->
    <view class="sync-tests">
      <button class="sync-btn online" bindtap="testOnlineSync">
        æµ‹è¯•åœ¨çº¿åŒæ­¥
      </button>
      <button class="sync-btn offline" bindtap="testOfflineMode">
        æµ‹è¯•ç¦»çº¿æ¨¡å¼
      </button>
      <button class="sync-btn manual" bindtap="testManualSync">
        æµ‹è¯•æ‰‹åŠ¨åŒæ­¥
      </button>
    </view>

    <!-- åŒæ­¥æµ‹è¯•ç»“æœ -->
    <view class="sync-results" wx:if="{{syncTestResults.length > 0}}">
      <view class="results-title">åŒæ­¥æµ‹è¯•ç»“æœ</view>
      <view class="results-list">
        <view 
          wx:for="{{syncTestResults}}" 
          wx:key="time"
          class="result-row"
        >
          <text class="test-name">{{item.name}}</text>
          <text class="test-status {{item.success ? 'success' : 'failed'}}">
            {{item.success ? 'âœ…' : 'âŒ'}}
          </text>
          <text class="test-time">{{item.time}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ•°æ®åˆ†æé¡µé¢ -->
  <view class="tab-content" wx:if="{{currentTab === 3}}">
    <view class="section-title">ğŸ“Š æ•°æ®åˆ†æå±•ç¤º</view>
    
    <!-- ç»Ÿè®¡å¡ç‰‡ -->
    <view class="stats-cards">
      <view class="stat-card">
        <view class="stat-number">{{statistics.totalPractices}}</view>
        <view class="stat-label">æ€»ç»ƒä¹ æ¬¡æ•°</view>
      </view>
      <view class="stat-card">
        <view class="stat-number">{{statistics.totalTime}}</view>
        <view class="stat-label">æ€»æ—¶é•¿(åˆ†é’Ÿ)</view>
      </view>
      <view class="stat-card">
        <view class="stat-number">{{statistics.avgQuality}}</view>
        <view class="stat-label">å¹³å‡è´¨é‡</view>
      </view>
      <view class="stat-card">
        <view class="stat-number">{{statistics.bestScore}}</view>
        <view class="stat-label">æœ€ä½³è¯„åˆ†</view>
      </view>
    </view>

    <!-- æ€§èƒ½ç›‘æ§ -->
    <view class="performance-monitor">
      <view class="monitor-title">æ€§èƒ½ç›‘æ§</view>
      <view class="monitor-metrics">
        <view class="metric-item">
          <text class="metric-label">å†…å­˜ä½¿ç”¨</text>
          <text class="metric-value">{{performanceMetrics.memoryUsage}}MB</text>
        </view>
        <view class="metric-item">
          <text class="metric-label">å“åº”æ—¶é—´</text>
          <text class="metric-value">{{performanceMetrics.responseTime}}ms</text>
        </view>
        <view class="metric-item">
          <text class="metric-label">æ¸²æŸ“æ—¶é—´</text>
          <text class="metric-value">{{performanceMetrics.renderTime}}ms</text>
        </view>
      </view>
    </view>

    <!-- ç»ƒä¹ å†å² -->
    <view class="practice-history" wx:if="{{practiceHistory.length > 0}}">
      <view class="history-title">æœ€è¿‘ç»ƒä¹ è®°å½•</view>
      <view class="history-list">
        <view 
          wx:for="{{practiceHistory}}" 
          wx:key="id"
          class="history-item"
        >
          <view class="history-content">{{item.content || 'ç»ƒä¹ è®°å½•'}}</view>
          <view class="history-meta">
            <text class="history-quality">{{item.quality}}åˆ†</text>
            <text class="history-duration">{{item.duration}}s</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- è°ƒè¯•é¢æ¿ -->
  <view class="debug-panel {{showDebugPanel ? 'open' : ''}}">
    <view class="debug-header" bindtap="toggleDebugPanel">
      <text class="debug-title">ğŸ” è°ƒè¯•é¢æ¿</text>
      <text class="debug-toggle">{{showDebugPanel ? 'ğŸ”½' : 'ğŸ”¼'}}</text>
    </view>
    
    <view class="debug-content" wx:if="{{showDebugPanel}}">
      <!-- å®æ—¶æ—¥å¿— -->
      <view class="debug-logs">
        <view class="logs-header">
          <text class="logs-title">å®æ—¶æ—¥å¿—</text>
          <button class="clear-btn" bindtap="clearTestData">æ¸…ç©º</button>
        </view>
        <scroll-view class="logs-container" scroll-y scroll-top="{{0}}">
          <view 
            wx:for="{{testLogs}}" 
            wx:key="index"
            class="log-item"
          >
            {{item}}
          </view>
        </scroll-view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ§åˆ¶æ  -->
  <view class="demo-footer">
    <button class="control-btn" bindtap="toggleDebugPanel">
      {{showDebugPanel ? 'éšè—' : 'æ˜¾ç¤º'}}è°ƒè¯•
    </button>
    <button class="control-btn export" bindtap="exportTestReport">
      å¯¼å‡ºæŠ¥å‘Š
    </button>
    <button class="control-btn clear" bindtap="clearTestData">
      æ¸…ç©ºæ•°æ®
    </button>
  </view>
</view> 