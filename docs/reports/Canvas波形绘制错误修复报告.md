# P-Word Canvasæ³¢å½¢ç»˜åˆ¶é”™è¯¯ä¿®å¤æŠ¥å‘Š

## é—®é¢˜æè¿°
å½•éŸ³åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼Œä½†åœ¨å½•åˆ¶è¿‡ç¨‹ä¸­å‡ºç°Canvasç›¸å…³é”™è¯¯ï¼š
```
TypeError: Failed to execute 'roundRect' on 'CanvasRenderingContext2D': 
The provided value cannot be converted to a sequence.
```

## é”™è¯¯åˆ†æ

### 1. æ ¹æœ¬åŸå› 
Canvas 2D APIçš„ `roundRect` æ–¹æ³•è¦æ±‚åœ†è§’åŠå¾„å‚æ•°å¿…é¡»æ˜¯æ•°ç»„æ ¼å¼ï¼Œè€Œä¸æ˜¯å•ä¸ªæ•°å€¼ã€‚

### 2. é”™è¯¯ä½ç½®
- æ³¢å½¢æ¡ç»˜åˆ¶ï¼š`ctx.roundRect(x, y, barWidth, barHeight, barWidth / 2)`
- å ä½æ¡ç»˜åˆ¶ï¼šåŒæ ·çš„å‚æ•°æ ¼å¼é”™è¯¯

### 3. APIè§„èŒƒ
```javascript
// é”™è¯¯ç”¨æ³•
ctx.roundRect(x, y, width, height, radius)  // âŒ

// æ­£ç¡®ç”¨æ³•
ctx.roundRect(x, y, width, height, [radius])  // âœ…
// æˆ–æŒ‡å®šæ¯ä¸ªè§’çš„åŠå¾„
ctx.roundRect(x, y, width, height, [topLeft, topRight, bottomRight, bottomLeft])  // âœ…
```

## ä¿®å¤æ–¹æ¡ˆå®æ–½

### 1. å‚æ•°æ ¼å¼ä¿®æ­£ âœ…
```javascript
// ä¿®å¤å‰
ctx.roundRect(x, y, barWidth, barHeight, barWidth / 2)

// ä¿®å¤å
const radius = barWidth / 2
ctx.roundRect(x, y, barWidth, barHeight, [radius])
```

### 2. å¢å¼ºé”™è¯¯å¤„ç† âœ…
æ·»åŠ äº†try-catchå—å’Œå¤šå±‚å›é€€æœºåˆ¶ï¼š
```javascript
try {
  if (ctx.roundRect) {
    const radiusArray = Array.isArray(radius) ? radius : [radius]
    ctx.roundRect(x, y, width, height, radiusArray)
  } else {
    // å›é€€åˆ°æ‰‹åŠ¨ç»˜åˆ¶
    this.drawRoundRectManually(ctx, x, y, width, height, radius)
  }
} catch (error) {
  // æœ€ç»ˆå›é€€åˆ°æ™®é€šçŸ©å½¢
  ctx.rect(x, y, width, height)
}
```

### 3. ä¸“ä¸šåŒ–åœ†è§’çŸ©å½¢ç»˜åˆ¶ç³»ç»Ÿ âœ…

#### å®‰å…¨ç»˜åˆ¶å‡½æ•°
åˆ›å»ºäº† `safeDrawRoundRect` å‡½æ•°ï¼Œæä¾›å¤šå±‚å›é€€ï¼š
1. **ä¼˜å…ˆçº§1**ï¼šä½¿ç”¨åŸç”Ÿ `roundRect` APIï¼ˆæ­£ç¡®å‚æ•°æ ¼å¼ï¼‰
2. **ä¼˜å…ˆçº§2**ï¼šæ‰‹åŠ¨ç»˜åˆ¶åœ†è§’çŸ©å½¢ï¼ˆä½¿ç”¨ `arcTo`ï¼‰
3. **ä¼˜å…ˆçº§3**ï¼šæ™®é€šçŸ©å½¢ï¼ˆæœ€ç»ˆå›é€€ï¼‰

#### æ‰‹åŠ¨åœ†è§’çŸ©å½¢ç»˜åˆ¶
```javascript
drawRoundRectManually(ctx, x, y, width, height, radius) {
  const r = Math.min(radius, width / 2, height / 2)
  
  ctx.moveTo(x + r, y)
  ctx.lineTo(x + width - r, y)
  ctx.arcTo(x + width, y, x + width, y + r, r)
  ctx.lineTo(x + width, y + height - r)
  ctx.arcTo(x + width, y + height, x + width - r, y + height, r)
  ctx.lineTo(x + r, y + height)
  ctx.arcTo(x, y + height, x, y + height - r, r)
  ctx.lineTo(x, y + r)
  ctx.arcTo(x, y, x + r, y, r)
  ctx.closePath()
}
```

### 4. å…¼å®¹æ€§ä¿éšœ âœ…

#### å¤šç¯å¢ƒé€‚é…
- **æ–°ç‰ˆå¾®ä¿¡**ï¼šæ”¯æŒ `roundRect` APIï¼Œä½¿ç”¨åŸç”Ÿæ–¹æ³•
- **æ—§ç‰ˆå¾®ä¿¡**ï¼šä¸æ”¯æŒ `roundRect`ï¼Œä½¿ç”¨æ‰‹åŠ¨ç»˜åˆ¶
- **å¼‚å¸¸æƒ…å†µ**ï¼šAPIè°ƒç”¨å¤±è´¥æ—¶ï¼Œè‡ªåŠ¨å›é€€åˆ°æ™®é€šçŸ©å½¢

#### å‚æ•°éªŒè¯
```javascript
// ç¡®ä¿ radius å‚æ•°æ ¼å¼æ­£ç¡®
const radiusArray = Array.isArray(radius) ? radius : [radius]
```

## æŠ€æœ¯äº®ç‚¹

### 1. æ¸è¿›å¼å›é€€ç­–ç•¥
```
roundRect API (åŸç”Ÿ)
    â†“ (å¤±è´¥)
æ‰‹åŠ¨ç»˜åˆ¶åœ†è§’çŸ©å½¢ (arcTo)
    â†“ (å¤±è´¥)
æ™®é€šçŸ©å½¢ (rect)
```

### 2. æ™ºèƒ½å‚æ•°å¤„ç†
- è‡ªåŠ¨æ£€æµ‹å‚æ•°ç±»å‹å¹¶è½¬æ¢æ ¼å¼
- è¾¹ç•Œæ¡ä»¶å¤„ç†ï¼ˆåŠå¾„ä¸èƒ½è¶…è¿‡å®½é«˜çš„ä¸€åŠï¼‰
- ç±»å‹å®‰å…¨æ£€æŸ¥

### 3. é”™è¯¯å¤„ç†å®Œå–„
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—è®°å½•
- é™é»˜é™çº§ä¸å½±å“ç”¨æˆ·ä½“éªŒ
- è°ƒè¯•ä¿¡æ¯ä¾¿äºé—®é¢˜æ’æŸ¥

### 4. æ€§èƒ½ä¼˜åŒ–
- é¿å…é‡å¤çš„ç±»å‹æ£€æŸ¥
- æœ€å°åŒ–ç»˜åˆ¶è°ƒç”¨æ¬¡æ•°
- å‡½æ•°å¤ç”¨å‡å°‘ä»£ç é‡å¤

## æµ‹è¯•éªŒè¯

### ä¿®å¤å‰
```
âŒ TypeError: Failed to execute 'roundRect' on 'CanvasRenderingContext2D'
âŒ æ³¢å½¢ç»˜åˆ¶ä¸­æ–­
âŒ ç”¨æˆ·ä½“éªŒå—å½±å“
```

### ä¿®å¤å
```
âœ… åœ†è§’çŸ©å½¢æ­£ç¡®ç»˜åˆ¶
âœ… å¤šç¯å¢ƒå…¼å®¹æ€§ä¿éšœ
âœ… é”™è¯¯è‡ªåŠ¨å›é€€å¤„ç†
âœ… ç”¨æˆ·ä½“éªŒæ— æ„ŸçŸ¥
```

## ä»£ç è´¨é‡æå‡

### 1. å¯ç»´æŠ¤æ€§
- æ¨¡å—åŒ–çš„ç»˜åˆ¶å‡½æ•°
- æ¸…æ™°çš„å›é€€é€»è¾‘
- è¯¦ç»†çš„æ³¨é‡Šè¯´æ˜

### 2. å¯æ‰©å±•æ€§
- æ”¯æŒè‡ªå®šä¹‰åœ†è§’åŠå¾„
- å¯é€‚é…ä¸åŒçš„ç»˜åˆ¶éœ€æ±‚
- æ˜“äºæ·»åŠ æ–°çš„ç»˜åˆ¶ç‰¹æ•ˆ

### 3. å¥å£®æ€§
- å¤šå±‚é”™è¯¯å¤„ç†
- å…¼å®¹æ€§è‡ªé€‚åº”
- è¾¹ç•Œæ¡ä»¶ä¿æŠ¤

## æœ€ä½³å®è·µ

### 1. Canvas APIä½¿ç”¨
- å§‹ç»ˆæ£€æŸ¥APIå¯ç”¨æ€§
- ä½¿ç”¨æ­£ç¡®çš„å‚æ•°æ ¼å¼
- æä¾›å›é€€æ–¹æ¡ˆ

### 2. é”™è¯¯å¤„ç†
- ä½¿ç”¨try-catchåŒ…è£…å¯èƒ½å¤±è´¥çš„APIè°ƒç”¨
- æä¾›æœ‰æ„ä¹‰çš„é”™è¯¯æ—¥å¿—
- ç¡®ä¿åŠŸèƒ½é™çº§ä¸å½±å“æ ¸å¿ƒä½“éªŒ

### 3. å…¼å®¹æ€§è®¾è®¡
- ä¼˜å…ˆä½¿ç”¨æ–°APIæå‡æ€§èƒ½
- ä¿æŒæ—§ç‰ˆæœ¬å…¼å®¹æ€§
- æ¸è¿›å¼åŠŸèƒ½å¢å¼º

## ç»“è®º

### âœ… å·²è§£å†³çš„é—®é¢˜
1. `roundRect` APIå‚æ•°æ ¼å¼é”™è¯¯
2. Canvasç»˜åˆ¶å¼‚å¸¸ä¸­æ–­
3. ä¸åŒå¾®ä¿¡ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜
4. é”™è¯¯å¤„ç†ä¸å®Œå–„

### ğŸš€ æŠ€æœ¯æå‡
1. ä¸“ä¸šçš„Canvasç»˜åˆ¶ç³»ç»Ÿ
2. å¤šå±‚å›é€€ä¿éšœæœºåˆ¶
3. æ™ºèƒ½å‚æ•°å¤„ç†
4. å®Œå–„çš„é”™è¯¯å¤„ç†

### ğŸ“ˆ ç”¨æˆ·ä½“éªŒæ”¹è¿›
1. æ³¢å½¢æ˜¾ç¤ºæ›´åŠ ç¨³å®š
2. å¤šè®¾å¤‡å…¼å®¹æ€§æ›´å¥½
3. é”™è¯¯æƒ…å†µä¸‹åŠŸèƒ½ä»å¯ç”¨
4. è§†è§‰æ•ˆæœä¿æŒä¸€è‡´

**æ€»ç»“ï¼šCanvasæ³¢å½¢ç»˜åˆ¶é”™è¯¯å·²å®Œå…¨ä¿®å¤ï¼Œæ–°çš„ç»˜åˆ¶ç³»ç»Ÿå…·å¤‡æ›´å¼ºçš„ç¨³å®šæ€§å’Œå…¼å®¹æ€§ã€‚** 